%%{init: {'theme': 'default', 'themeVariables': { 'fontSize': '16px', 'fontFamily': 'arial', 'primaryColor': '#326ce5', 'primaryTextColor': '#fff', 'primaryBorderColor': '#255db1', 'lineColor': '#666', 'secondaryColor': '#f96', 'tertiaryColor': '#fff' }}}%%
flowchart TD
    classDef default fill:#f9f9f9,stroke:#333,stroke-width:2px,color:#333
    classDef success fill:#d4edda,stroke:#28a745,stroke-width:2px,color:#28a745
    classDef warning fill:#fff3cd,stroke:#ffc107,stroke-width:2px,color:#333
    classDef error fill:#f8d7da,stroke:#dc3545,stroke-width:2px,color:#dc3545
    classDef primary fill:#cce5ff,stroke:#0d6efd,stroke-width:2px,color:#0d6efd
    
    Start[/"ğŸš€ ×”×ª×—×œ×ª ×’×™×‘×•×™"/] --> EnvCheck{{"ğŸ” ×‘×“×™×§×ª<br/>×¡×‘×™×‘×”"}}
    
    EnvCheck -->|× ×›×©×œ| InstallReq["ğŸ“¦ ×”×ª×§× ×ª<br/>×“×¨×™×©×•×ª"]
    InstallReq --> EnvCheck
    
    EnvCheck -->|×”×¦×œ×™×—| LoadConfig["âš™ï¸ ×˜×¢×™× ×ª<br/>×”×’×“×¨×•×ª"]
    
    LoadConfig --> ApiCheck{{"ğŸ”‘ ×‘×“×™×§×ª<br/>××¤×ª×— API"}}
    ApiCheck -->|×œ× ×ª×§×™×Ÿ| SetKey["ğŸ” ×”×’×“×¨×ª<br/>××¤×ª×— API"]
    SetKey --> ApiCheck
    
    ApiCheck -->|×ª×§×™×Ÿ| GetTables["ğŸ“‹ ×§×‘×œ×ª ×¨×©×™××ª<br/>×˜×‘×œ××•×ª"]
    GetTables --> TableLoop["ğŸ“Š ×¢×™×‘×•×“<br/>×˜×‘×œ××•×ª"]
    TableLoop --> Download["â¬‡ï¸ ×”×•×¨×“×ª<br/>× ×ª×•× ×™×"]
    Download --> SaveCSV["ğŸ’¾ ×©××™×¨×”<br/>×œ-CSV"]
    SaveCSV --> MoreTables{"×¢×•×“<br/>×˜×‘×œ××•×ª?"}
    
    MoreTables -->|×›×Ÿ| TableLoop
    MoreTables -->|×œ×| Cleanup["ğŸ§¹ × ×™×§×•×™ ×’×™×‘×•×™×™×<br/>×™×©× ×™×"]
    
    Cleanup --> Log["ğŸ“ ×ª×™×¢×•×“<br/>×ª×•×¦××•×ª"]
    Log --> End[/"âœ… ×’×™×‘×•×™<br/>×”×•×©×œ×"/]
    
    subgraph Schedule ["â° ×ª×–××•×Ÿ"]
        Timer["â±ï¸ ×˜×™×™××¨"] -->|×™×•××™/×©×‘×•×¢×™| Start
    end

    class Start,End primary
    class EnvCheck,ApiCheck,MoreTables warning
    class InstallReq,SetKey error
    class LoadConfig,GetTables,TableLoop,Download,SaveCSV,Cleanup,Log default
    class Timer,Schedule success